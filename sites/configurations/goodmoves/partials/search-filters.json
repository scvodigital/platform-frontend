{{#if request.params.query.regions ~}}
{
  "terms": {
    "local_authority_slug": {{{stringify (arrayify request.params.query.regions)}}}
  }
},
{{/if ~}}
{{#if request.params.query.sectors ~}}
{
  "terms": {
    "sectors_slugs": {{{stringify (arrayify request.params.query.sectors)}}}
  }
},
{{/if ~}}
{{#if request.params.query.roles ~}}
{
  "terms": {
    "roles_slugs": {{{stringify (arrayify request.params.query.roles)}}}
  }
},
{{/if ~}}
{{#if request.params.query.statuses ~}}
{
  "terms": {
    "role_status_slug": {{{stringify (arrayify request.params.query.statuses)}}}
  }
},
{{/if}}
{{#ifAll request.params.query.location request.params.query.outer-ne request.params.query.outer-sw ~}}
{
  "geo_bounding_box": {
    "geo_vacancy_coords": {
      "top_right": {{{stringify request.params.query.outer-ne}}},
      "bottom_left": {{{stringify request.params.query.outer-sw}}}
    }
  }
},
{{/ifAll ~}}
{
  "exists": {
    "field": "title"
  }
}
