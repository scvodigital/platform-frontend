{
  "size": 12,
  "from": {{multiply (subtract (default request.params.query.page 1) 1) 12}},
  "_source": [
    "Id",
    "slug",
    "charity_number",
    "title",
    "alias",
    "description",
    "goodhq_organisation",
    "geo_organisation_coords",
    "postcode",
    "has_logo",
    "logo_url",
    "facebook",
    "twitter",
    "website",
    "website_url",
    "rendered.json_ld"
  ],
  "query": {
    "bool": {
      "must": [
        {
          "term": {
            "has_logo": true
          }
        },
        {
          "term": {
            "has_vacancies": "true"
          }
        },
        {{#if request.params.query.keywords ~}}
        {
          "query_string": {
            "query": {{{stringify request.params.query.keywords}}},
            "fields": ["text_bag_boost^5", "text_bag"],
            "default_operator": "AND",
            "analyzer": "snowball"
          }
        }
        {{else}}
        {
          "match_all": {}
        }
        {{/if ~}}
      ]
    }
  }
}