<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script type="text/javascript">
var tabs = new mdc.tabs.MDCTabBar(document.querySelector("#vacancy-tab-bar"));
var panels = document.querySelector(".panels");
tabs.preventDefaultOnClick = true;
function updatePanel(index) {
  var activePanel = panels.querySelector(".panel.panel--active");
  if (activePanel) {
    activePanel.classList.remove("panel--active");
  }
  var newActivePanel = panels.querySelector(
    ".panel:nth-child(" + (index + 1) + ")"
  );
  if (newActivePanel) {
    newActivePanel.classList.add("panel--active");
  }
}
tabs.listen("MDCTabBar:change", function(t) {
  var tabs = t.detail;
  var nthChildIndex = tabs.activeTabIndex;
  updatePanel(nthChildIndex);
  if (goodmoves.maps.vacancyMap) {
    window.setTimeout(function() {
      var map = goodmoves.maps.vacancyMap;
      map.invalidateSize();
    }, 0);
  }
  if (mdeEditors.length > 0) {
    window.setTimeout(function() {
      mdeEditors.forEach(function(editor) {
        editor.codemirror.refresh(); 
      });
    }, 0);
  }
});

{{#if data.auth}}
var mdeEditors = [];
$(document).ready(function() {
  $('textarea[data-simple-mde]').each(function(i, o) {
    var mdeEditor = new SimpleMDE({ element: o, forceSync: true });
    o.mde = mdeEditor;
    mdeEditors.push(mdeEditor);
  });
});
{{/if}}
</script>
