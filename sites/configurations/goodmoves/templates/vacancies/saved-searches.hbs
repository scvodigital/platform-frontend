{{> vacancy_search_form this instance_id="perm"}}

<div id="detailed-results-container" class="container-content goodmoves-saved-searches">
  <div class="pull-right">
    <a href="/settings" class="mdc-button mdc-button--raised v-margin-full">
      <span class="far fa-cog mdc-list-item__graphic" aria-hidden="true"></span>
      Email alert settings
    </a>
  </div>
  <h1 class="mdc-typography--headline3 v-margin-full">
    Searches
  </h1>

  <ul class="mdc-list mdc-list--two-line mdc-list--avatar-list mdc-elevation--z3">
    <li class="mdc-list-item mdc-list-item--header">
      <span class="mdc-list-item__graphic far" aria-hidden="true"></span>
      <div class="mdc-layout-grid">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-9-desktop mdc-layout-grid__cell--span-6-tablet mdc-layout-grid__cell--span-3-phone saved-search">
            <span class="mdc-list-item__text">
              <strong>Search name</strong>
            </span>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-2-desktop mdc-layout-grid__cell--span-2-tablet mdc-layout-grid__cell--span-1-phone saved-search-email-switch">
            <span class="mdc-list-item__text">
              <strong>Add to email</strong>
            </span>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-1-desktop mdc-layout-grid__cell--span-1-tablet mdc-layout-grid__cell--span-1-phone saved-search-email-switch">
            <span class="mdc-list-item__text">
              <strong>Delete</strong>
            </span>
          </div>
        </div>
      </div>
    </li>
    {{#each data.saved_searches.items}}
      <li class="mdc-list-item mdc-ripple-upgraded">
        <span class="mdc-list-item__graphic far fa-search fa-2x" aria-hidden="true"></span>
        <div class="mdc-layout-grid">
          <div class="mdc-layout-grid__inner">
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-9-desktop mdc-layout-grid__cell--span-5-tablet mdc-layout-grid__cell--span-2-phone saved-search">
              <span class="mdc-list-item__text">
                <a href="/search?{{{this.querystring}}}">{{name}}</a>
                <div class="mdc-list-item__secondary-text">
                  {{#with (querystring querystring)}}
                    {{#if keywords}}
                      <strong>Keywords: </strong> {{keywords}}
                    {{/if}}
                    {{#if roles}}
                      <strong>Roles: </strong>
                      {{#each (arrayify roles)}}
                         {{getProperty @root.data.termsMaps.roles.slugsMap (concat this ".term")}}
                        {{#unless @last}}, {{/unless}}
                      {{/each}}
                    {{/if}}
                    {{#if sectors}}
                      <strong>Sectors: </strong>
                      {{#each (arrayify sectors)}}
                         {{getProperty @root.data.termsMaps.sectors.slugsMap (concat this ".term")}}
                        {{#unless @last}}, {{/unless}}
                      {{/each}}
                    {{/if}}
                    {{#if statuses}}
                      <strong>Statuses: </strong>
                      {{#each (arrayify statuses)}}
                         {{getProperty @root.data.termsMaps.statuses.slugsMap (concat this ".term")}}
                        {{#unless @last}}, {{/unless}}
                      {{/each}}
                    {{/if}}
                    {{#ifAll location distance}}
                        Within <strong>{{round (multiply distance 0.00062137)}}</strong> miles of <strong>{{location}}</strong>
                    {{/ifAll}}
                  {{/with}}
                </div>
              </span>
            </div>
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-2-desktop mdc-layout-grid__cell--span-2-tablet mdc-layout-grid__cell--span-1-phone saved-search-email-switch">
              <div class="mdc-switch">
                <input type="checkbox" id="email-switch-{{@index}}" class="mdc-switch__native-control" role="switch" {{#if this.subscribed}}checked="checked"{{/if}}>
                <div class="mdc-switch__background">
                  <div class="mdc-switch__knob"></div>
                </div>
              </div>
              <label for="email-switch-{{@index}}">
                <span class="far fa-envelope fa-2x"></span>
              </label>
            </div>
            <form action="/delete-search" method="POST" class="mdc-layout-grid__cell mdc-layout-grid__cell--span-1-desktop mdc-layout-grid__cell--span-1-tablet mdc-layout-grid__cell--span-1-phone">
              <input type="hidden" name="name" value="{{name}}">
              <button type="submit" class="saved-search-remove mdc-icon-button" data-mdc-auto-init="MDCRipple">
                <span class="far fa-trash-alt" aria-hidden="true"></span>
              </button>
            </form>
          </div>
        </div>
      </li>
      {{#unless @last}}
        <li class="mdc-list-divider" role="separator"></li>
      {{/unless}}
    {{/each}}
  </ul>

  <!-- <h2 class="mdc-typography--headline4 v-margin">
    Email alert preferences
  </h2>
  <p class="mdc-typography--body1">
    You have 1 saved search for your email alerts.
  </p>

  <form action="/update-email-preferences" method="POST" class="v-margin-full">
    <h3 class="mdc-typography--headline5 v-margin">
      Select day
    </h3>
    {{#each (split "monday,tuesday,wednesday,thursday,friday,saturday,sunday" ",")}}
      <div class="mdc-switch">
        <input type="checkbox" id="email-switch-{{this}}" class="mdc-switch__native-control" role="switch"
          {{~#if (contains @root.data.email_days this)~}}checked="checked"{{/if}} name="{{this}}" onchange="$('#email-preferences-submit').prop('disabled', false);">
        <div class="mdc-switch__background">
          <div class="mdc-switch__knob"></div>
        </div>
      </div>
      <label for="email-switch-{{this}}">
        {{capitalize this}}
      </label>
    {{/each}}
    <button class="mdc-button mdc-button--raised mdc-ripple-surface mdc-ripple-surface--primary" type="submit" id="email-preferences-submit" data-mdc-auto-init="MDCRipple" disabled>Update preferences</button> -->
  </form>
</div>
