{
	"_source": [
		"rendered.scvo_gist",
		"geo_vacancy_coords"
	],
	"query": {
        "bool": {
            {{#ifAny request.body.sectors request.body.roles request.body.statuses}}
                "filter": [
                    {{#if request.body.sectors}}
                        {
                            "terms": {
                                "sectors": {{{stringify request.body.sectors}}}
                            }
                        }
                        {{#ifAny request.body.roles request.body.statuses}},{{/ifAny}}
                    {{/if}}
                    {{#if request.body.roles}}
                        {
                            "terms": {
                                "roles": {{{stringify request.body.roles}}}
                            }
                        }
                        {{#if request.body.statuses}},{{/if}}
                    {{/if}}
                    {{#if request.body.statuses}}
                        {
                            "terms": {
                                "status": {{{stringify request.body.statuses}}}
                            }
                        }
                    {{/if}}
                ]
                {{#if request.body.keywords}},{{/if}}
            {{/ifAny}}
            {{#if request.body.keywords}}
                "must": [
                    {
                        "query_string": {
                            "query": {{{stringify (join request.body.keywords " AND ")}}},
                            "default_field": "text_bag",
                            "default_operator": "AND",
                            "analyzer": "snowball"
                        }
                    }
                ]
            {{/if}}
        }
	}
}
